# ER-–¥–∏–∞–≥—Ä–∞–º–º–∞

```mermaid
erDiagram
    USER ||--o{ SCENARIO : "—Å–æ–∑–¥–∞–µ—Ç"
    USER {
        int id PK
        string username
        string email
        string role
    }

    SCENARIO ||--o{ ROUTE : "—Å–æ–¥–µ—Ä–∂–∏—Ç"
    SCENARIO ||--o{ CALCULATION : "–∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç"
    SCENARIO {
        uuid id PK
        int user_id FK
        string name
        timestamp created_at
    }

    ROUTE ||--o{ STOP : "–≤–∫–ª—é—á–∞–µ—Ç"
    ROUTE {
        uuid id PK
        uuid scenario_id FK
        string name
        string type
    }

    STOP {
        uuid id PK
        uuid route_id FK
        string name
        float lat
        float lon
        int order
    }

    CALCULATION ||--o{ METRIC : "–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç"
    CALCULATION {
        uuid id PK
        uuid scenario_id FK
        string status
        timestamp created_at
    }

    METRIC {
        uuid id PK
        uuid calculation_id FK
        numeric coverage_percent
        numeric avg_travel_time
        numeric overload_score
    }
```

## üîó –û–ø–∏—Å–∞–Ω–∏–µ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏

### üßë USER ‚Üí üìÅ SCENARIO  
–û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (**1:N**).

### üìÅ SCENARIO ‚Üí üõ£Ô∏è ROUTE  
–í –æ–¥–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (**1:N**).

### üõ£Ô∏è ROUTE ‚Üí ‚õî STOP  
–ö–∞–∂–¥—ã–π –º–∞—Ä—à—Ä—É—Ç –≤–∫–ª—é—á–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Å—Ç–∞–Ω–æ–≤–æ–∫ (**1:N**).

### üìÅ SCENARIO ‚Üí üßÆ CALCULATION  
–î–ª—è —Å—Ü–µ–Ω–∞—Ä–∏—è –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–∞—Å—á—ë—Ç–æ–≤ (**1:N**).

### üßÆ CALCULATION ‚Üí üìà METRIC  
–ö–∞–∂–¥—ã–π —Ä–∞—Å—á—ë—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ (**1:1** –∏–ª–∏ **1:N**, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏).

---

### ‚öôÔ∏è –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã (id)** –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–∏–ø `UUID` –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏.
- **–í–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ (FK)** –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Å—Å—ã–ª–æ—á–Ω—É—é —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å:
  - –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è **–∫–∞—Å–∫–∞–¥–Ω–æ** —É–¥–∞–ª—è–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ —Ä–∞—Å—á—ë—Ç—ã.
  - –£–¥–∞–ª–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞ **–∫–∞—Å–∫–∞–¥–Ω–æ** —É–¥–∞–ª—è–µ—Ç –µ–≥–æ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏.
- –ü–æ–ª—è `lat` –∏ `lon` –≤ —Å—É—â–Ω–æ—Å—Ç–∏ **STOP** —Ö—Ä–∞–Ω—è—Ç –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.
- –°—Ç–∞—Ç—É—Å —Ä–∞—Å—á—ë—Ç–∞ (`status`) –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è:
  - `queued` ‚è≥
  - `processing` üîÑ
  - `done` ‚úÖ
  - `error` ‚ùå
