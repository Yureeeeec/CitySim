# üìä –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (Sequence Diagram)

![image](https://github.com/user-attachments/assets/3621e65f-5171-450c-954b-5b2c8d8f7f89)

@startuml
actor –ê–Ω–∞–ª–∏—Ç–∏–∫
actor –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
actor –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å

participant "–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å" as UI
participant "API Gateway" as API
participant "–ú–æ–¥—É–ª—å –¥–∞–Ω–Ω—ã—Ö" as Data
participant "–†–∞—Å—á—ë—Ç–Ω—ã–π –º–æ–¥—É–ª—å" as Calc
participant "–•—Ä–∞–Ω–∏–ª–∏—â–µ" as DB
participant "–°–µ—Ä–≤–∏—Å –æ—Ç—á—ë—Ç–æ–≤" as Report

== –°—Ü–µ–Ω–∞—Ä–∏–π: –ê–Ω–∞–ª–∏—Ç–∏–∫ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç –º–∞—Ä—à—Ä—É—Ç ==

–ê–Ω–∞–ª–∏—Ç–∏–∫ -> UI: –ó–∞–≥—Ä—É–∑–∏—Ç—å GTFS/CSV
UI -> API: /scenarios (POST)
API -> Data: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞
alt –í–∞–ª–∏–¥–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
  Data -> DB: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π
  DB --> Data: ID —Å—Ü–µ–Ω–∞—Ä–∏—è
  Data --> API: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
  API --> UI: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ
else –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  Data --> API: –û—à–∏–±–∫–∞ "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç"
  API --> UI: –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É
end

–ê–Ω–∞–ª–∏—Ç–∏–∫ -> UI: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç
UI -> API: /routes (PATCH)
API -> Data: –û–±–Ω–æ–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç
Data -> DB: –ó–∞–ø–∏—Å–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
DB --> Data: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
Data --> API: OK
API --> UI: –û–±–Ω–æ–≤–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é

–ê–Ω–∞–ª–∏—Ç–∏–∫ -> UI: –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
UI -> API: /simulation (POST)
API -> Calc: –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞—Å—á—ë—Ç
Calc -> Data: –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
Data --> Calc: –ú–∞—Ä—à—Ä—É—Ç—ã + –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
Calc --> API: –ü—Ä–æ–≥—Ä–µ—Å—Å (WebSocket)
API --> UI: –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä 0-100%

Calc -> Report: –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏
Report -> DB: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
DB --> Report: ID —Ä–∞—Å—á—ë—Ç–∞
Report --> API: –ì–æ—Ç–æ–≤–æ
API --> UI: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–†–∞—Å—á—ë—Ç –∑–∞–≤–µ—Ä—à—ë–Ω"

== –°—Ü–µ–Ω–∞—Ä–∏–π: –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ—Ç—á—ë—Ç–æ–º ==

–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å -> UI: –û—Ç–∫—Ä—ã—Ç—å –æ—Ç—á—ë—Ç
UI -> API: /reports (GET)
API -> Report: –ó–∞–ø—Ä–æ—Å–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
Report -> DB: –ü–æ–ª—É—á–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏
DB --> Report: –î–∞–Ω–Ω—ã–µ
Report --> API: –û—Ç—á—ë—Ç + –≥—Ä–∞—Ñ–∏–∫–∏
API --> UI: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ

–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å -> UI: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
UI -> API: /comments (POST)
API -> DB: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
DB --> API: OK
API --> UI: –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

== –°—Ü–µ–Ω–∞—Ä–∏–π: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É ==

–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä -> UI: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
UI -> API: /users (POST)
API -> DB: –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å
DB --> API: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
API --> UI: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä -> UI: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–≤–æ—Ç—ã
UI -> API: /settings (PUT)
API -> DB: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥
DB --> API: OK
API --> UI: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã"
@enduml

## üìù –û–ø–∏—Å–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 1. –°—Ü–µ–Ω–∞—Ä–∏–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

#### üì• –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ (GTFS/CSV).
- –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ.
- –ü—Ä–∏ —É—Å–ø–µ—Ö–µ ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –º–∞—Ä—à—Ä—É—Ç—ã –Ω–∞ –∫–∞—Ä—Ç–µ.

#### ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ë–î.
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.

#### ‚öôÔ∏è –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ä–∞—Å—á—ë—Ç —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º.
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –æ—Ç—á—ë—Ç–∞—Ö.

---

### 2. –°—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è

#### üìä –†–∞–±–æ—Ç–∞ —Å –æ—Ç—á—ë—Ç–æ–º
- –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ API.
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞.
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

---

### 3. –°—Ü–µ–Ω–∞—Ä–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

#### üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π.
- –î–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ë–î.

#### üõ† –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–≤–æ—Ç
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–∏–º–∏—Ç —Ñ–∞–π–ª–æ–≤).

---

## üîç –ö–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

- **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ GTFS/CSV –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º.
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ä–∞—Å—á—ë—Ç—ã**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ WebSocket –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**:
  - –†–∞—Å—á—ë—Ç–Ω—ã–π –º–æ–¥—É–ª—å –æ—Ç–¥–µ–ª—ë–Ω –æ—Ç —Å–µ—Ä–≤–∏—Å–∞ –æ—Ç—á—ë—Ç–æ–≤.
  - API Gateway –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã.
